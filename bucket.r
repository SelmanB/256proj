> require(data.table)
> pin<-readRDS("pinnaclewres.rds")
> b3<-readRDS("bet365wres.rds")
> bf<-readRDS("betfairwres.rds")
> bfx<-readRDS("betfairxwres.rds")
> bfx
       matchId odd1  odd2 oddx result
   1: 04PCiQzK 1.50  7.83 4.14   home
   2: 04zko0D5 1.17 25.00 9.20   home
   3: 061xSktd 2.21  3.23 3.61   away
   4: 069WnDBn 3.76  2.12 3.28   draw
   5: 06AqtiDs 1.47  7.65 4.61   away
  ---                                
2610: zXmHZnXA 2.71  2.82 3.19   away
2611: zXtioUye 2.88  2.58 3.28   draw
2612: zXweIXVE 2.60  3.04 3.04   draw
2613: zy3x0uCs 1.23 18.10 6.70   home
2614: zZ6f59Ue 1.27  1.60 1.65   <NA>
> bfxp<-readRDS("betfairxoddswp.rds")
> bfxp
       matchId odd1  odd2 oddx        ph         pa        px     totp
   1: 04PCiQzK 1.50  7.83 4.14 0.6666667 0.12771392 0.2415459 1.035926
   2: 04zko0D5 1.17 25.00 9.20 0.8547009 0.04000000 0.1086957 1.003397
   3: 061xSktd 2.21  3.23 3.61 0.4524887 0.30959752 0.2770083 1.039095
   4: 069WnDBn 3.76  2.12 3.28 0.2659574 0.47169811 0.3048780 1.042534
   5: 06AqtiDs 1.47  7.65 4.61 0.6802721 0.13071895 0.2169197 1.027911
  ---                                                                 
2610: zXmHZnXA 2.71  2.82 3.19 0.3690037 0.35460993 0.3134796 1.037093
2611: zXtioUye 2.88  2.58 3.28 0.3472222 0.38759690 0.3048780 1.039697
2612: zXweIXVE 2.60  3.04 3.04 0.3846154 0.32894737 0.3289474 1.042510
2613: zy3x0uCs 1.23 18.10 6.70 0.8130081 0.05524862 0.1492537 1.017510
2614: zZ6f59Ue 1.27  1.60 1.65 0.7874016 0.62500000 0.6060606 2.018462
            pxn        pan       phn
   1: 0.2331690 0.12328473 0.6435463
   2: 0.1083277 0.03986460 0.8518077
   3: 0.2665862 0.29794934 0.4354644
   4: 0.2924395 0.45245363 0.2551068
   5: 0.2110297 0.12716955 0.6618007
  ---                               
2610: 0.3022675 0.34192676 0.3558057
2611: 0.2932374 0.37279788 0.3339648
2612: 0.3155340 0.31553398 0.3689320
2613: 0.1466852 0.05429784 0.7990170
2614: 0.3002586 0.30964167 0.3900997
> bfxp[,result:=bfx$result]
> saveRDS(bfxp,"betfairxwres.rds")
> bfx<-bfxp
> bfx
       matchId odd1  odd2 oddx        ph         pa        px     totp
   1: 04PCiQzK 1.50  7.83 4.14 0.6666667 0.12771392 0.2415459 1.035926
   2: 04zko0D5 1.17 25.00 9.20 0.8547009 0.04000000 0.1086957 1.003397
   3: 061xSktd 2.21  3.23 3.61 0.4524887 0.30959752 0.2770083 1.039095
   4: 069WnDBn 3.76  2.12 3.28 0.2659574 0.47169811 0.3048780 1.042534
   5: 06AqtiDs 1.47  7.65 4.61 0.6802721 0.13071895 0.2169197 1.027911
  ---                                                                 
2610: zXmHZnXA 2.71  2.82 3.19 0.3690037 0.35460993 0.3134796 1.037093
2611: zXtioUye 2.88  2.58 3.28 0.3472222 0.38759690 0.3048780 1.039697
2612: zXweIXVE 2.60  3.04 3.04 0.3846154 0.32894737 0.3289474 1.042510
2613: zy3x0uCs 1.23 18.10 6.70 0.8130081 0.05524862 0.1492537 1.017510
2614: zZ6f59Ue 1.27  1.60 1.65 0.7874016 0.62500000 0.6060606 2.018462
            pxn        pan       phn result
   1: 0.2331690 0.12328473 0.6435463   home
   2: 0.1083277 0.03986460 0.8518077   home
   3: 0.2665862 0.29794934 0.4354644   away
   4: 0.2924395 0.45245363 0.2551068   draw
   5: 0.2110297 0.12716955 0.6618007   away
  ---                                      
2610: 0.3022675 0.34192676 0.3558057   away
2611: 0.2932374 0.37279788 0.3339648   draw
2612: 0.3155340 0.31553398 0.3689320   draw
2613: 0.1466852 0.05429784 0.7990170   home
2614: 0.3002586 0.30964167 0.3900997   <NA>
> pin[,diff:=phn-pan]
> b3[,diff:=phn-pan]
> bf[,diff:=phn-pan]
> bfx[,diff:=phn-pan]
> br<-(-5:5)/5
> bucketpin<-cut(pin$diff,breaks=br,labels=1:10)
> bucketb3<-cut(pin$diff,breaks=br,labels=1:10)
> bucketb3<-cut(b3$diff,breaks=br,labels=1:10)
> bucketbf<-cut(bf$diff,breaks=br,labels=1:10)
> bucketbfx<-cut(bfx$diff,breaks=br,labels=1:10)
> pin[,bucket:=bucketpin]
> b3[,bucket:=bucketb3]
> bf[,bucket:=bucketbf]
> bfx[,bucket:=bucketbfx]
> pin
       matchId odd1  odd2 oddx        ph         pa        px     totp
   1: 004f4ING 1.67  5.95 3.95 0.5988024 0.16806723 0.2531646 1.020034
   2: 02oVDuv1 1.83  5.00 3.63 0.5464481 0.20000000 0.2754821 1.021930
   3: 04PCiQzK 1.47  8.50 4.40 0.6802721 0.11764706 0.2272727 1.025192
   4: 04vrPwsg 2.06  4.18 3.38 0.4854369 0.23923445 0.2958580 1.020529
   5: 04zko0D5 1.15 22.00 8.40 0.8695652 0.04545455 0.1190476 1.034067
  ---                                                                 
3298: zXtioUye 2.89  2.67 3.33 0.3460208 0.37453184 0.3003003 1.020853
3299: zXweIXVE 2.65  3.12 3.10 0.3773585 0.32051282 0.3225806 1.020452
3300: zy3x0uCs 1.23 18.30 6.70 0.8130081 0.05464481 0.1492537 1.016907
3301: zylytbNg 2.21  3.45 3.59 0.4524887 0.28985507 0.2785515 1.020895
3302: zZ6f59Ue 1.79  4.56 3.99 0.5586592 0.21929825 0.2506266 1.028584
            phn        pan       pxn result        diff bucket
   1: 0.5870415 0.16476627 0.2481922   away  0.42227523      8
   2: 0.5347215 0.19570809 0.2695704   away  0.33901346      7
   3: 0.6635559 0.11475613 0.2216880   home  0.54879974      8
   4: 0.4756717 0.23442192 0.2899064   away  0.24124975      7
   5: 0.8409174 0.04395704 0.1151256   home  0.79696032      9
  ---                                                         
3298: 0.3389526 0.36688130 0.2941661   draw -0.02792868      5
3299: 0.3697955 0.31408908 0.3161155   draw  0.05570637      6
3300: 0.7994914 0.05373631 0.1467723   home  0.74575509      9
3301: 0.4432273 0.28392243 0.2728502   draw  0.15930489      6
3302: 0.5431343 0.21320402 0.2436617   <NA>  0.32993024      7
> b3
       matchId odd1  odd2 oddx        ph         pa        px     totp
   1: 004f4ING 1.67  6.00 3.90 0.5988024 0.16666667 0.2564103 1.021879
   2: 02oVDuv1 1.85  4.75 3.60 0.5405405 0.21052632 0.2777778 1.028845
   3: 04PCiQzK 1.50  7.00 4.00 0.6666667 0.14285714 0.2500000 1.059524
   4: 04vrPwsg 2.05  4.10 3.40 0.4878049 0.24390244 0.2941176 1.025825
   5: 04zko0D5 1.16 21.00 8.50 0.8620690 0.04761905 0.1176471 1.027335
  ---                                                                 
3299: zXtioUye 2.75  2.63 3.25 0.3636364 0.38022814 0.3076923 1.051557
3300: zXweIXVE 2.63  3.10 3.10 0.3802281 0.32258065 0.3225806 1.025389
3301: zy3x0uCs 1.22 15.00 6.00 0.8196721 0.06666667 0.1666667 1.053005
3302: zylytbNg 2.14  3.50 3.60 0.4672897 0.28571429 0.2777778 1.030782
3303: zZ6f59Ue 1.80  4.00 3.75 0.5555556 0.25000000 0.2666667 1.072222
            phn        pan       pxn result        diff bucket
   1: 0.5859815 0.16309819 0.2509203   away  0.42288333      8
   2: 0.5253860 0.20462401 0.2699900   away  0.32076196      7
   3: 0.6292135 0.13483146 0.2359551   home  0.49438202      8
   4: 0.4755245 0.23776224 0.2867133   away  0.23776224      7
   5: 0.8391313 0.04635201 0.1145167   home  0.79277924      9
  ---                                                         
3299: 0.3458076 0.36158592 0.2926065   draw -0.01577829      5
3300: 0.3708134 0.31459330 0.3145933   draw  0.05622010      6
3301: 0.7784120 0.06331085 0.1582771   home  0.71510119      9
3302: 0.4533353 0.27718213 0.2694826   draw  0.17615313      6
3303: 0.5181347 0.23316062 0.2487047   <NA>  0.28497409      7
> bf
       matchId odd1  odd2 oddx        ph         pa        px     totp
   1: 02oVDuv1 1.87  4.75 3.70 0.5347594 0.21052632 0.2702703 1.015556
   2: 04zko0D5 1.15 26.00 8.50 0.8695652 0.03846154 0.1176471 1.025674
   3: 069WnDBn 3.80  2.15 3.40 0.2631579 0.46511628 0.2941176 1.022392
   4: 06H610QA 2.50  2.90 3.50 0.4000000 0.34482759 0.2857143 1.030542
   5: 08lLzk5P 3.00  2.62 3.25 0.3333333 0.38167939 0.3076923 1.022705
  ---                                                                 
1375: zXDmLx4H 2.45  3.50 3.00 0.4081633 0.28571429 0.3333333 1.027211
1376: zXmHZnXA 2.75  2.87 3.20 0.3636364 0.34843206 0.3125000 1.024568
1377: zXweIXVE 2.60  3.10 3.10 0.3846154 0.32258065 0.3225806 1.029777
1378: zylytbNg 2.15  3.50 3.75 0.4651163 0.28571429 0.2666667 1.017497
1379: zZ6f59Ue 1.75  4.00 3.50 0.5714286 0.25000000 0.2857143 1.107143
            phn       pan       pxn result        diff bucket
   1: 0.5265681 0.2073015 0.2661304   away  0.31926655      7
   2: 0.8477990 0.0374988 0.1147022   home  0.81030018     10
   3: 0.2573944 0.4549296 0.2876761   draw -0.19753521      5
   4: 0.3881453 0.3346080 0.2772467   draw  0.05353728      6
   5: 0.3259330 0.3732057 0.3008612   away -0.04727273      5
  ---                                                        
1375: 0.3973510 0.2781457 0.3245033   draw  0.11920530      6
1376: 0.3549166 0.3400769 0.3050065   away  0.01483972      6
1377: 0.3734940 0.3132530 0.3132530   draw  0.06024096      6
1378: 0.4571180 0.2808010 0.2620810   draw  0.17631694      6
1379: 0.5161290 0.2258065 0.2580645   <NA>  0.29032258      7
> bfx
       matchId odd1  odd2 oddx        ph         pa        px     totp
   1: 04PCiQzK 1.50  7.83 4.14 0.6666667 0.12771392 0.2415459 1.035926
   2: 04zko0D5 1.17 25.00 9.20 0.8547009 0.04000000 0.1086957 1.003397
   3: 061xSktd 2.21  3.23 3.61 0.4524887 0.30959752 0.2770083 1.039095
   4: 069WnDBn 3.76  2.12 3.28 0.2659574 0.47169811 0.3048780 1.042534
   5: 06AqtiDs 1.47  7.65 4.61 0.6802721 0.13071895 0.2169197 1.027911
  ---                                                                 
2610: zXmHZnXA 2.71  2.82 3.19 0.3690037 0.35460993 0.3134796 1.037093
2611: zXtioUye 2.88  2.58 3.28 0.3472222 0.38759690 0.3048780 1.039697
2612: zXweIXVE 2.60  3.04 3.04 0.3846154 0.32894737 0.3289474 1.042510
2613: zy3x0uCs 1.23 18.10 6.70 0.8130081 0.05524862 0.1492537 1.017510
2614: zZ6f59Ue 1.27  1.60 1.65 0.7874016 0.62500000 0.6060606 2.018462
            pxn        pan       phn result        diff bucket
   1: 0.2331690 0.12328473 0.6435463   home  0.52026158      8
   2: 0.1083277 0.03986460 0.8518077   home  0.81194308     10
   3: 0.2665862 0.29794934 0.4354644   away  0.13751508      6
   4: 0.2924395 0.45245363 0.2551068   draw -0.19734680      5
   5: 0.2110297 0.12716955 0.6618007   away  0.53463117      8
  ---                                                         
2610: 0.3022675 0.34192676 0.3558057   away  0.01387895      6
2611: 0.2932374 0.37279788 0.3339648   draw -0.03883311      5
2612: 0.3155340 0.31553398 0.3689320   draw  0.05339806      6
2613: 0.1466852 0.05429784 0.7990170   home  0.74471912      9
2614: 0.3002586 0.30964167 0.3900997   <NA>  0.08045807      6
> saveRDS(pin,"pinnaclehist.rds")
> saveRDS(b3,"bet365hist.rds")
> saveRDS(bf,"betfairhist.rds")
> saveRDS(bfx,"betfairxhist.rds")

